name: QA playwright regression

on:
 workflow_dispatch:
   inputs:
     test_type:
        description: "select test type"
        required: true
        default: "sanity"
        type: choice
        options:
          - sanity
          - regression


jobs:
  qa_tests:
    runs-on: ubuntu-latest
    timeout-minutes: 90

    steps:
       - name: Checkout code
         uses: actions/checkout@v4

       - name: Set Node.js
         uses: actions/setup-node@v4
         with:
            node-version: 18
            cache: npm   
        
       - name: Install dependencies
         run: npm ci
         
       - name: Install playwright browsers
         run: npx playwright install --with-deps
         
       - name: Run QA playwright tests
         run: |
            if ["${{inputs.test_type}}" == "sanity"]; then
              echo "Running sanity regression"
              npx playwright test --grep "@sanity"

            else 
              echo "Running full regression"
              npx playwight test --grep "@regression"
            fi
          
       - name: Upload playwright reports
         if: always()
         uses: actions/upload-artifact@v4
         with:
            name: playwright-report
            path: playwright-report/


            

        

       



